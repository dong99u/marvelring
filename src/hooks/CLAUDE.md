<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>
## useInfiniteProducts Race Condition Fix (2026-01-28)

**Problem**: Products not loading on listing pages - stale closure in useEffect caused by React Compiler optimization

**Root Cause**: Two separate useEffects created race condition:
1. First reset state (cursor=0)
2. Second called memoized loadMore() with OLD cursor from closure

**Solution**: Consolidated into single useEffect that:
- Resets state
- Calls server action directly with cursor=0 (no stale closure)
- Uses inline async function to avoid dependency issues

**Key Learning**: When React Compiler is enabled, be extra careful with useCallback + useEffect patterns that depend on frequently changing state like cursor/pagination values.

**Files**: /Users/parkdongkyu/my_project/marvelring/src/hooks/useInfiniteProducts.ts
